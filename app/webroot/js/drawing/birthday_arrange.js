// Generated by CoffeeScript 1.3.3
var BirthdayArrange,
  __hasProp = {}.hasOwnProperty,
  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

BirthdayArrange = (function(_super) {

  __extends(BirthdayArrange, _super);

  function BirthdayArrange() {
    return BirthdayArrange.__super__.constructor.apply(this, arguments);
  }

  BirthdayArrange.prototype.upload = function() {
    var data, saveData, type, url;
    url = this.makeUrl();
    console.log(url);
    saveData = this.getImageData();
    $.ajax({
      url: url,
      type: "POST",
      data: {
        "img_file": saveData
      },
      success: function(res) {
        alert("save done");
        return location.href = "/";
      }
    });
    type = "image/png";
    return data = this.canvas.toDataURL(type);
  };

  BirthdayArrange.prototype.setImages = function() {
    var imageList;
    return imageList = this.getImages();
  };

  BirthdayArrange.prototype.getImageData = function() {
    var data, type;
    type = "image/png";
    data = this.canvas.toDataURL(type);
    data = data.replace('data:image/png;base64,', '');
    console.log(data);
    return data;
  };

  BirthdayArrange.prototype.getImages = function() {
    var collaboratorId, collaboratorList, planId, url, _i, _len,
      _this = this;
    return [
      {
        "http://www.google.co.jp/imgres?um=1&hl=ja&sa=N&biw=1440&bih=779&tbm=isch&tbnid=SZy4QAskl7tsQM:&imgrefurl=http://www.fujimura-auto.co.jp/topics/2006.03.24mls.html&imgurl=http://www.fujimura-auto.co.jp/topics/2006.03.26mls/hamao-gga.jpg&w=3072&h=2048&ei=Wh8-UP_RHcyYmQXfqIHYAQ&zoom=1&iact=rc&dur=109&sig=101403282153143219819&page=1&tbnh=127&tbnw=153&start=0&ndsp=29&ved=1t:429,r:2,s:0,i:77&tx=36&ty=59": "http://www.google.co.jp/imgres?um=1&hl=ja&sa=N&biw=1440&bih=779&tbm=isch&tbnid=SZy4QAskl7tsQM:&imgrefurl=http://www.fujimura-auto.co.jp/topics/2006.03.24mls.html&imgurl=http://www.fujimura-auto.co.jp/topics/2006.03.26mls/hamao-gga.jpg&w=3072&h=2048&ei=Wh8-UP_RHcyYmQXfqIHYAQ&zoom=1&iact=rc&dur=109&sig=101403282153143219819&page=1&tbnh=127&tbnw=153&start=0&ndsp=29&ved=1t:429,r:2,s:0,i:77&tx=36&ty=59"
      }
    ];
    planId = "";
    $.ajax({
      url: "/get_plan",
      type: "GET",
      async: false,
      dataType: "json",
      success: function(res) {
        return planId = res.Plan.id;
      }
    });
    url = "/get_collaborators/" + planId;
    collaboratorList = [];
    $.ajax({
      url: url,
      type: "GET",
      async: false,
      dataType: "json",
      success: function(res) {
        var element, _i, _len, _results;
        _results = [];
        for (_i = 0, _len = res.length; _i < _len; _i++) {
          element = res[_i];
          _results.push(collaboratorList.push(element.Collaborator.id));
        }
        return _results;
      }
    });
    for (_i = 0, _len = collaboratorList.length; _i < _len; _i++) {
      collaboratorId = collaboratorList[_i];
      imageList.push(fetchImage(collaboratorId));
    }
    return imageList;
  };

  BirthdayArrange.prototype.fetchImage = function(id) {};

  BirthdayArrange.prototype.makeUrl = function() {
    var planId,
      _this = this;
    planId = "";
    $.ajax({
      url: "/get_plan",
      type: "GET",
      async: false,
      dataType: "json",
      success: function(res) {
        return planId = res.Plan.id;
      }
    });
    return "/plan/" + planId + "/photo";
  };

  return BirthdayArrange;

})(CanvasImages);
